---
import Icon from './Icon.astro';
---

<button
  id="theme-toggle"
  type="button"
  class="p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors"
  aria-label="Toggle dark mode"
>
  <Icon name="sun" class="hidden dark:block" />
  <Icon name="moon" class="block dark:hidden" />
</button>

<script is:inline>
  function initThemeToggle() {
    const toggle = document.getElementById('theme-toggle');
    if (!toggle) return;

    toggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
      if (!localStorage.getItem('theme')) {
        document.documentElement.classList.toggle('dark', e.matches);
      }
    });
  }

  initThemeToggle();
  document.addEventListener('astro:page-load', initThemeToggle);
</script>
