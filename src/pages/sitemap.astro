---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import Header from '@components/layout/Header.astro';
import Footer from '@components/layout/Footer.astro';
import Container from '@components/sections/Container.astro';
import Section from '@components/sections/Section.astro';

const blogPosts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());
const products = await getCollection('products', ({ data }) => !data.draft);
const pages = await getCollection('pages', ({ data }) => !data.draft);
---

<BaseLayout title="Sitemap" description="Complete site map">
  <Header />

  <Section padding="xl">
    <Container size="md">
      <h1 class="text-4xl font-bold font-heading mb-8">Sitemap</h1>

      <div class="space-y-8">
        <div>
          <h2 class="text-2xl font-bold mb-4">Pages</h2>
          <ul class="space-y-2">
            <li><a href="/" class="text-primary-600 hover:underline">Home</a></li>
            <li><a href="/about" class="text-primary-600 hover:underline">About</a></li>
            <li><a href="/contact" class="text-primary-600 hover:underline">Contact</a></li>
            {pages.map(page => (
              <li><a href={`/${page.id}`} class="text-primary-600 hover:underline">{page.data.title}</a></li>
            ))}
          </ul>
        </div>

        {blogPosts.length > 0 && (
          <div>
            <h2 class="text-2xl font-bold mb-4">Blog ({blogPosts.length} posts)</h2>
            <ul class="space-y-2">
              {blogPosts.map(post => (
                <li><a href={`/blog/${post.id}`} class="text-primary-600 hover:underline">{post.data.title}</a></li>
              ))}
            </ul>
          </div>
        )}

        {products.length > 0 && (
          <div>
            <h2 class="text-2xl font-bold mb-4">Products ({products.length} items)</h2>
            <ul class="space-y-2">
              {products.map(product => (
                <li><a href={`/products/${product.id}`} class="text-primary-600 hover:underline">{product.data.title}</a></li>
              ))}
            </ul>
          </div>
        )}
      </div>
    </Container>
  </Section>

  <Footer />
</BaseLayout>
